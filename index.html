<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>IVA ‚ù§Ô∏è ‚Äî Balloons</title>
<style>
  :root{ --tint: rgba(255, 182, 193, 0.20); }
  html,body{ margin:0; height:100%; background:#000;
    font-family: system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; -webkit-tap-highlight-color: transparent; }
  .scene{ position:fixed; inset:0; overflow:hidden; display:flex; align-items:center; justify-content:center;
    background-image: linear-gradient(var(--tint), var(--tint)), url('background.jpg');
    background-size: cover; background-position: center; background-repeat: no-repeat; touch-action: manipulation; }
  .layer{ position:absolute; inset:0; pointer-events:none; z-index:1; }
  .intro{ position:fixed; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center;
    background: rgba(0,0,0,0.25); z-index:10; color:#fff; text-align:center; animation: hold 3.2s ease-out forwards; }
  @keyframes hold{ 0%{opacity:1} 90%{opacity:1} 100%{opacity:0; visibility:hidden} }
  .intro .heart{ width:min(42vmin, 320px); height:min(42vmin, 320px); position:relative; filter: drop-shadow(0 12px 32px rgba(0,0,0,0.25)); }
  .heart svg{ width:100%; height:100%; display:block; }
  .pulse{ animation: pulse 1.2s ease-in-out infinite; transform-origin:center; }
  @keyframes pulse{ 0%{ transform: scale(0.98) } 50%{ transform: scale(1.06) } 100%{ transform: scale(0.98) } }
  .intro h1{ margin:16px 0 0; font-size: clamp(18px, 3.6vmin, 28px); text-shadow: 0 2px 12px rgba(0,0,0,0.35); }
  .control{ position: fixed; left:50%; bottom:18px; transform:translateX(-50%); z-index:12;
    display:inline-flex; align-items:center; gap:10px; padding:10px 16px; border-radius:999px;
    background: rgba(255,255,255,0.78); backdrop-filter: blur(6px); color:#8a0040; font-weight:600; letter-spacing:0.2px;
    box-shadow: 0 6px 24px rgba(0,0,0,0.22); cursor:pointer; user-select:none; }
  .control:active{ transform:translateX(-50%) scale(0.98); }
  .control .dot{ width:10px; height:10px; border-radius:50%; background:#19a31d; }
  .control.paused .dot{ background:#b00020; }
  .balloon{ --size: 90px; position:absolute; bottom:-120px; width:var(--size); height:var(--size);
    pointer-events:auto; display:flex; align-items:center; justify-content:center;
    transform-origin:center bottom; cursor:pointer; user-select:none; -webkit-user-select:none; z-index:2; }
  .balloon .h{ width:calc(var(--size) * 0.6); height:calc(var(--size) * 0.6); }
  .string{ position:absolute; bottom:-20px; width:2px; height:18px; background:linear-gradient(#d37d99,#b74f78); border-radius:2px; left:50%; transform:translateX(-50%); }
  @keyframes floatUp{ 0%{ transform: translateY(0) rotate(-8deg); opacity:0; } 5%{opacity:1} 50%{ transform: translateY(-60vh) rotate(6deg); }
    100%{ transform: translateY(-120vh) rotate(-6deg); opacity:0; } }
  .burst{ position:fixed; width:100px; height:100px; pointer-events:none; transform:translate(-50%,-50%); z-index:9;
    opacity:0.95; mix-blend-mode:screen; filter:blur(0.5px); animation: burstAnim .45s ease-out forwards; }
  @keyframes burstAnim{ 0%{ transform: scale(0.4) translate(-50%,-50%); opacity:1; } 100%{ transform: scale(1.6) translate(-50%,-50%); opacity:0; } }
</style>
</head>
<body>
<div class="scene" id="scene"><div class="layer" id="layer"></div></div>
<div class="intro" id="intro" aria-hidden="true">
  <div class="heart pulse">
    <svg viewBox="0 0 32 29" preserveAspectRatio="xMidYMid meet">
      <defs><linearGradient id="g" x1="0" x2="0" y1="0" y2="1">
        <stop offset="0%" stop-color="#d90045"/><stop offset="100%" stop-color="#90002f"/>
      </linearGradient></defs>
      <path d="M23.6 0C20.9 0 18.5 1.7 17 3.9 15.5 1.7 13.1 0 10.4 0 4.7 0 0 4.6 0 10.3 0 17.5 9 23.6 16 28 23 23.6 32 17.5 32 10.3 32 4.6 27.3 0 21.6 0z" fill="url(#g)"/>
      <text x="16" y="16.6" text-anchor="middle" font-size="9" font-weight="700" font-family="system-ui" fill="#fff">IVA</text>
    </svg>
  </div>
  <h1>Happy Birthday IVA üíñ</h1>
</div>
<button class="control paused" id="ctrl" aria-pressed="false"><span class="dot"></span><span id="label">Tap to Start</span></button>
<script>
const CONFIG = { spawnRatePerSec: 0.9, maxOnScreen: 10, sizeMin: 56, sizeMax: 120, floatDurationMin: 6.5, floatDurationMax: 11,
  heartColors: ["#ff6b9a","#ff7fa6","#ff4c7a","#ff9bb3"], };
const MUSIC_VOL = 0.15, MUSIC_FADE_MS = 2000;
const layer = document.getElementById('layer'), ctrl = document.getElementById('ctrl'), label = document.getElementById('label');
let running = false, spawnTimer = null, currentCount = 0;
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function playPopTone(){ const duration=0.06,osc=audioCtx.createOscillator(),gain=audioCtx.createGain(),bp=audioCtx.createBiquadFilter();
  bp.type="bandpass"; bp.frequency.value=1000+Math.random()*400; gain.gain.value=0.0001; osc.type="triangle"; osc.frequency.value=480+Math.random()*380;
  osc.connect(bp); bp.connect(gain); gain.connect(audioCtx.destination); const now=audioCtx.currentTime; gain.gain.setValueAtTime(0.0001,now);
  gain.gain.exponentialRampToValueAtTime(0.03,now+0.006); gain.gain.exponentialRampToValueAtTime(0.001,now+duration);
  osc.start(); osc.stop(now+duration+0.02); }
const music = new Audio("music.mp3"); music.loop=true; music.volume=0.0;
function fadeVolume(target,ms){ const start=music.volume,delta=target-start,steps=Math.max(1,Math.floor(ms/50)); let i=0;
  clearInterval(music._fadeTimer); music._fadeTimer=setInterval(()=>{ i++; const t=i/steps, eased=t<0.5?2*t*t:-1+(4-2*t)*t;
    music.volume=Math.max(0,Math.min(1,start+delta*eased)); if(i>=steps){music.volume=target; clearInterval(music._fadeTimer);} },50); }
function sayIVA(){ if(!("speechSynthesis" in window)) return; const utter=new SpeechSynthesisUtterance("Iva");
  const voices=window.speechSynthesis.getVoices(); let preferred=voices.find(v=>/es-ES|Spanish|es_ES/i.test(v.lang+v.name))||voices.find(v=>/es/i.test(v.lang))||voices[0];
  if(preferred) utter.voice=preferred; utter.lang="es-ES"; utter.rate=0.98; utter.pitch=1.05; utter.volume=1.0; window.speechSynthesis.cancel(); window.speechSynthesis.speak(utter);}
function spawnBalloon(){ if(!running||currentCount>=CONFIG.maxOnScreen) return; const el=document.createElement('div'); el.className="balloon";
  el.style.setProperty('--size',(rand(CONFIG.sizeMin,CONFIG.sizeMax))+'px'); el.style.left=(rand(6,94))+'%';
  const color=CONFIG.heartColors[Math.floor(Math.random()*CONFIG.heartColors.length)];
  el.innerHTML=`<div class="h" style="filter: drop-shadow(0 4px 6px rgba(0,0,0,0.10));"><svg viewBox="0 0 32 29" preserveAspectRatio="xMidYMid meet" style="width:100%;height:100%;">
    <path d="M23.6 0C20.9 0 18.5 1.7 17 3.9 15.5 1.7 13.1 0 10.4 0 4.7 0 0 4.6 0 10.3 0 17.5 9 23.6 16 28 23 23.6 32 17.5 32 10.3 32 4.6 27.3 0 21.6 0z" fill="${color}"></path></svg></div><div class="string"></div>`;
  const dur=randFloat(CONFIG.floatDurationMin,CONFIG.floatDurationMax),delay=randFloat(0,1.1);
  el.style.animation=`floatUp ${dur}s linear ${delay}s forwards`; layer.appendChild(el); currentCount++;
  el.addEventListener('click',ev=>{ev.stopPropagation();popBalloon(el);}); el.addEventListener('touchstart',ev=>{ev.preventDefault();popBalloon(el);},{passive:false});
  el.addEventListener('animationend',()=>{if(el.parentNode)el.parentNode.removeChild(el);currentCount=Math.max(0,currentCount-1);});}
function popBalloon(el){ const rect=el.getBoundingClientRect(),burst=document.createElement('div'); burst.className='burst';
  burst.style.left=(rect.left+rect.width/2)+'px'; burst.style.top=(rect.top+rect.height/2)+'px';
  burst.innerHTML=`<svg viewBox="0 0 120 120" width="120" height="120"><g><circle cx="60" cy="60" r="8" fill="#fff" /></g></svg>`; document.body.appendChild(burst);
  const heart=el.querySelector('.h'); if(heart){heart.style.transform='scale(0.2) rotate(-20deg)';heart.style.transition='transform 0.15s ease-out';}
  if(audioCtx.state==='suspended') audioCtx.resume(); playPopTone(); setTimeout(sayIVA,90);
  setTimeout(()=>{if(el.parentNode)el.parentNode.removeChild(el);currentCount=Math.max(0,currentCount-1);},120);
  setTimeout(()=>{if(burst.parentNode)burst.parentNode.removeChild(burst);},480);}
function rand(min,max){return Math.floor(Math.random()*(max-min+1))+min;} function randFloat(min,max){return Math.random()*(max-min)+min;}
function startSpawning(){ if(running) return; running=true; ctrl.classList.remove('paused'); ctrl.setAttribute('aria-pressed','true'); label.textContent='Pause';
  if(music.paused){music.play().then(()=>fadeVolume(MUSIC_VOL,MUSIC_FADE_MS)).catch(()=>{});} else{fadeVolume(MUSIC_VOL,MUSIC_FADE_MS);}
  spawnTimer=setInterval(()=>{if(Math.random()<CONFIG.spawnRatePerSec)spawnBalloon();},1000);}
function stopSpawning(){ running=false; ctrl.classList.add('paused'); ctrl.setAttribute('aria-pressed','false'); label.textContent='Tap to Start';
  if(spawnTimer){clearInterval(spawnTimer);spawnTimer=null;} fadeVolume(0.0,MUSIC_FADE_MS); setTimeout(()=>{if(!running)music.pause();},MUSIC_FADE_MS+50);}
ctrl.addEventListener('click',()=>{if(audioCtx.state==='suspended')audioCtx.resume(); if(!running)startSpawning();else stopSpawning();});
setTimeout(()=>{document.getElementById('intro').style.display='none'; if(typeof speechSynthesis!=='undefined')speechSynthesis.getVoices(); stopSpawning();},3200);
document.addEventListener('touchstart',function once(){if(audioCtx.state==='suspended')audioCtx.resume();document.removeEventListener('touchstart',once);},{passive:true});
</script>
</body>
</html>